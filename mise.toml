[tools]
python = "3.13"

[tasks.verify]
description = "Verify video: mise run verify -- VIDEO AUDIO"
run = "python scripts/verify_video.py {{arg(i=0)}} {{arg(i=1)}}"
# Example: mise run verify -- youtube/output/01-attention.mp4 youtube/pl/audio/01-attention.m4a

[tasks.transcribe]
description = "Transcribe audio files"
run = "python scripts/transcribe.py {{arg(i=0, default='3')}}"
# Example: mise run transcribe -- 4

[tasks.prepare]
description = "Prepare slides for video: mise run prepare -- EPISODE_NUM"
run = "python scripts/prepare_slides.py {{arg(i=0)}}"
# Example: mise run prepare -- 26

[tasks.video]
description = "Generate video from concat.txt: mise run video -- EPISODE_NUM"
run = "python scripts/generate_video.py {{arg(i=0)}} {{option(name='skip-verify', short='s')}}"
# Example: mise run video -- 28
# Example: mise run video -- 28 -s

[tasks.compress]
description = "Compress PNG files: mise run compress -- PATH [--threshold SIZE]"
run = "python scripts/compress_images.py {{arg(i=0)}} {{arg(i=1)}} {{arg(i=2)}} {{arg(i=3)}} {{arg(i=4)}}"
# Example: mise run compress -- youtube/thumbnails/
# Example: mise run compress -- youtube/thumbnails/ --threshold 1MB --dry-run

[tasks.verify-concat]
description = "Verify concat.txt: mise run verify-concat -- EPISODE_NUM [--check-dims]"
run = "python scripts/verify_concat.py"
raw = true
# Example: mise run verify-concat -- 28
# Example: mise run verify-concat -- 28 --check-dims

[tasks.rename-audio]
description = "Rename audio files to match whitepaper names"
run = "python scripts/rename_audio.py"

[tasks.rename-slides]
description = "Rename slides dirs/PDFs to match whitepaper names"
run = "python scripts/rename_slides.py"

[tasks.rename-thumbnails]
description = "Rename thumbnails to match whitepaper names and compress"
run = "python scripts/rename_thumbnails.py"
raw = true

[tasks.lint]
description = "Run ruff linter"
run = "ruff check scripts/"

[tasks.format]
description = "Format code with ruff"
run = "ruff format scripts/"

[tasks.test]
description = "Run tests"
run = "pytest scripts/tests/ -v"
